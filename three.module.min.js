"use strict";function initThreeJS(){function e(t,r,i,n,s,o,a,l,u,h){Object.defineProperty(this,"id",{value:j++}),this.name="",this.image=void 0!==t?t:e.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==r?r:e.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:1001,this.wrapT=void 0!==n?n:1001,this.magFilter=void 0!==s?s:1006,this.minFilter=void 0!==o?o:1008,this.anisotropy=void 0!==u?u:1,this.format=void 0!==a?a:1023,this.internalFormat=null,this.type=void 0!==l?l:1009,this.offset=new T(0,0),this.repeat=new T(1,1),this.center=new T(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new E,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==h?h:3e3,this.version=0}function t(){Object.defineProperty(this,"id",{value:I++}),this.name="",this.type="Object3D",this.parent=null,this.children=[];const e=new V,r=new D,i=new C,n=new V(1,1,1);r._onChange(function(){i.setFromEuler(r,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new G},normalMatrix:{value:new E}}),this.matrix=new G,this.matrixWorld=new G,this.matrixAutoUpdate=t.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new F,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function r(){Object.defineProperty(this,"id",{value:W++}),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=this.flatShading=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.toneMapped=this.visible=!0,this.userData={},this.version=0}function i(e,t,r){Array.isArray(e),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===r,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function n(e,t,r){i.call(this,new Uint16Array(e),t,r)}function s(e,t,r){i.call(this,new Float32Array(e),t,r)}function o(){Object.defineProperty(this,"id",{value:B+=2}),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0},this.userData={}}function a(e,r){t.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new o,this.material=r}function l(e){r.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}function u(){t.call(this),this.type="Camera",this.matrixWorldInverse=new G,this.projectionMatrix=new G,this.projectionMatrixInverse=new G}function h(e,t,r,i){u.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==r?r:.1,this.far=void 0!==i?i:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.updateProjectionMatrix()}function c(e,t){const r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function d(e,t){const r=this.cache;void 0!==t.x||void 0===t.r||r[0]===t.r&&r[1]===t.g&&r[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b)}function p(e,t){const r=this.cache;if(void 0!==(t=t.elements)){e:if(r.length!==t.length)var i=!1;else{for(let e=0,n=r.length;e<n;e++)if(r[e]!==t[e]){i=!1;break e}i=!0}if(!i){q.set(t),e.uniformMatrix4fv(this.addr,!1,q);for(let e=0,i=t.length;e<i;e++)r[e]=t[e]}}}function f(e,t,r){const i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.safeSetTexture2D(t||X,n)}function m(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=function(e){switch(t.type){case 5126:return c;case 35665:return d;case 35676:return p;case 35678:case 36198:case 36298:case 36306:case 35682:return f}}()}function g(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,35718);for(let s=0;s<r;++s){var i=e.getActiveUniform(t,s),n=e.getUniformLocation(t,i.name);const r=i.name,o=r.length;for(Y.lastIndex=0;;){const e=Y.exec(r),t=Y.lastIndex;let s=e[1];const a=e[3];if("]"===e[2]&&(s|=0),void 0===a||"["===a&&t+2===o){i=new m(s,i,n),this.seq.push(i),this.map[i.id]=i;break}}}}function v(e,t,r){return t=e.createShader(t),e.shaderSource(t,r),e.compileShader(t),t}function x(e){return""!==e}function y(){}function b(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision&&(t+="\n#define HIGH_PRECISION"),t}function M(e,t,r,i,n,s){function o(e){let t;return e||(t=3e3),t}const a=[],l=i.isWebGL2,u=i.logarithmicDepthBuffer,h=i.floatVertexTextures,c=i.vertexTextures;let d=i.precision;const p={},f="precision isWebGL2 supportsVertexTextures outputEncoding instancing instancingColor map mapEncoding matcap matcapEncoding aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap tangentSpaceNormalMap clearcoatMap clearcoatRoughnessMap clearcoatNormalMap displacementMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors vertexTangents vertexUvs uvsVertexOnly fog useFog fogExp2 flatShading sizeAttenuation logarithmicDepthBuffer maxBones useVertexTexture premultipliedAlpha alphaTest doubleSided flipSided depthPacking dithering sheen transmissionMap".split(" ");return{getParameters:function(r,i,n,s,a){let f,m;return n=s.fog,s=r.isMeshStandardMaterial?s.environment:null,t.get(r.envMap||s),(s=p[r.type])||(f=r.vertexShader,m=r.fragmentShader),{isWebGL2:l,shaderID:s,shaderName:r.type,vertexShader:f,fragmentShader:m,defines:r.defines,isRawShaderMaterial:!0===r.isRawShaderMaterial,glslVersion:r.glslVersion,precision:d,instancing:!0===a.isInstancedMesh,instancingColor:!0===a.isInstancedMesh&&null!==a.instanceColor,supportsVertexTextures:c,outputEncoding:e.outputEncoding,map:!!r.map,mapEncoding:o(r.map),combine:r.combine,vertexTangents:r.normalMap&&r.vertexTangents,vertexColors:r.vertexColors,fog:!!n,useFog:r.fog,fogExp2:n&&n.isFogExp2,flatShading:r.flatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:u,useVertexTexture:h,dithering:r.dithering,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:2===r.side,flipSided:1===r.side,depthPacking:void 0!==r.depthPacking&&r.depthPacking,index0AttributeName:r.index0AttributeName,customProgramCacheKey:r.customProgramCacheKey()}},getProgramCacheKey:function(t){const r=[];if(t.shaderID||(r.push(t.fragmentShader),r.push(t.vertexShader)),!1===t.isRawShaderMaterial){for(let e=0;e<f.length;e++)r.push(t[f[e]]);r.push(e.outputEncoding),r.push(e.gammaFactor)}return r.push(t.customProgramCacheKey),r.join()},getUniforms:function(e){let t;return p[e.type]||(t=e.uniforms),t},acquireProgram:function(t,r){let i;return void 0===i&&(i=new function(e,t,r,i){const n=e.getContext();var s=r.defines;i=r.vertexShader;let o=r.fragmentShader;r.shadowMapType,e=0<e.gammaFactor?e.gammaFactor:1;const a=r.isWebGL2?"":void 0,l=n.createProgram();if(s=r.glslVersion?"#version "+r.glslVersion+"\n":"",!r.isRawShaderMaterial)var u=[b(r),"#define SHADER_NAME "+r.shaderName,"",r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+e,r.useFog&&r.fog?"#define USE_FOG":"",r.map?"#define USE_MAP":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","\n"].filter(x).join("\n"),h=[a,b(r),"#define SHADER_NAME "+r.shaderName,"",r.alphaTest?"#define ALPHATEST "+r.alphaTest+(r.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+e,r.useFog&&r.fog?"#define USE_FOG":"",r.map?"#define USE_MAP":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.dithering?"#define DITHERING":"",R.encodings_pars_fragment,r.map?void 0:"",r.matcap?void 0:"",r.emissiveMap?void 0:"",function(e,t){e:{switch(t){case 3e3:t=["Linear","( value )"];break e}t=void 0}return"vec4 linearToOutputTexel( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}(0,r.outputEncoding),r.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(x).join("\n");let c,d;return i=i.replace(Z,y),o=o.replace(Z,y),r.isWebGL2&&!0!==r.isRawShaderMaterial&&(s="#version 300 es\n",u="#define attribute in\n#define varying out\n#define texture2D texture\n"+u,h=["#define varying in","300 es"===r.glslVersion?"":"out highp vec4 pc_fragColor;","300 es"===r.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+h),h=s+h+o,u=v(n,35633,s+u+i),i=v(n,35632,h),n.attachShader(l,u),n.attachShader(l,i),n.linkProgram(l),n.deleteShader(u),n.deleteShader(i),this.getUniforms=function(){return void 0===c&&(c=new g(n,l)),c},this.getAttributes=function(){if(void 0===d){const e={},t=n.getProgramParameter(l,35721);for(let r=0;r<t;r++){const t=n.getActiveAttrib(l,r).name;e[t]=n.getAttribLocation(l,t)}d=e}return d},this.name=r.shaderName,this.id=H++,this.cacheKey=t,this.usedTimes=1,this.program=l,this.vertexShader=u,this.fragmentShader=i,this}(e,r,t,n),a.push(i)),i},programs:a}}function w(e,t){if(e.groupOrder===t.groupOrder&&e.renderOrder===t.renderOrder&&e.z!==t.z)return t.z-e.z}function A(e){let t=new WeakMap;return{get:function(r,i){var n=t.get(r);return void 0===n?(n=new function(e){const t=[];let r=0;const i=[],n=[],s={id:-1};return{opaque:i,transparent:n,init:function(){r=0,i.length=0,n.length=0},push:function(o,a,l,u,h,c){let d=t[r];const p=e.get(l);void 0===d?(d={id:o.id,object:o,geometry:a,material:l,program:p.program||s,groupOrder:u,renderOrder:o.renderOrder,z:h,group:c},t[r]=d):(d.id=o.id,d.object=o,d.geometry=a,d.material=l,d.program=p.program||s,d.groupOrder=u,d.renderOrder=o.renderOrder,d.z=h,d.group=c),r++,(!0===l.transparent?n:i).push(d)},sort:function(e,t){1<i.length&&i.sort(e||fc),1<n.length&&n.sort(t||w)}}}(e),t.set(r,new WeakMap),t.get(r).set(i,n)):n=n.get(i),n}}}function S(e){h.call(this),this.cameras=e||[]}function P(t,r,i,n,s,o,a,l,u){e.call(this,t,r,i,n,s,o,a,l,u),this.needsUpdate=!0}function _(){Object.defineProperty(this,"id",{value:K+=2}),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.lineDistances=[],this.boundingSphere=this.boundingBox=null}const O={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e}};class T{constructor(e=0,t=0){Object.defineProperty(this,"isVector2",{value:!0}),this.x=e,this.y=t}clone(){return new this.constructor(this.x,this.y)}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}}class E{constructor(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,r,i,n,s,o,a,l){const u=this.elements;return u[0]=e,u[1]=i,u[2]=o,u[3]=t,u[4]=n,u[5]=a,u[6]=r,u[7]=s,u[8]=l,this}setFromMatrix4(e){return e=e.elements,this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}getInverse(e,t){var r=e.elements;e=this.elements,t=r[0];const i=r[1],n=r[2],s=r[3],o=r[4],a=r[5],l=r[6],u=r[7],h=(r=r[8])*o-a*u,c=a*l-r*s,d=u*s-o*l;var p=t*h+i*c+n*d;return 0===p?this.set(0,0,0,0,0,0,0,0,0):(p=1/p,e[0]=h*p,e[1]=(n*u-r*i)*p,e[2]=(a*i-n*o)*p,e[3]=c*p,e[4]=(r*t-n*l)*p,e[5]=(n*s-a*t)*p,e[6]=d*p,e[7]=(i*l-u*t)*p,e[8]=(o*t-i*s)*p,this)}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).getInverse(this).transpose()}}let j=0;e.DEFAULT_IMAGE=void 0,e.DEFAULT_MAPPING=300,e.prototype={constructor:e,isTexture:!0},Object.defineProperty(e.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}});class U{constructor(e=0,t=0,r=0,i=1){Object.defineProperty(this,"isVector4",{value:!0}),this.x=e,this.y=t,this.z=r,this.w=i}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}}class C{constructor(e=0,t=0,r=0,i=1){Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=e,this._y=t,this._z=r,this._w=i}setFromEuler(e,t){t=e._x;var r=e._y,i=e._z;e=e._order;var n=Math.cos;const s=Math.sin,o=n(t/2),a=n(r/2);switch(n=n(i/2),t=s(t/2),r=s(r/2),i=s(i/2),e){case"XYZ":this._x=t*a*n+o*r*i,this._y=o*r*n-t*a*i,this._z=o*a*i+t*r*n,this._w=o*a*n-t*r*i}return this}}class V{constructor(e=0,t=0,r=0){Object.defineProperty(this,"isVector3",{value:!0}),this.x=e,this.y=t,this.z=r}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}applyMatrix3(e){const t=this.x,r=this.y,i=this.z;return e=e.elements,this.x=e[0]*t+e[3]*r+e[6]*i,this.y=e[1]*t+e[4]*r+e[7]*i,this.z=e[2]*t+e[5]*r+e[8]*i,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,n=1/((e=e.elements)[3]*t+e[7]*r+e[11]*i+e[15]);return this.x=(e[0]*t+e[4]*r+e[8]*i+e[12])*n,this.y=(e[1]*t+e[5]*r+e[9]*i+e[13])*n,this.z=(e[2]*t+e[6]*r+e[10]*i+e[14])*n,this}divideScalar(e){return this.multiplyScalar(1/e)}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){return this.divideScalar(this.length()||1)}setFromMatrixPosition(e){return e=e.elements,this.x=e[12],this.y=e[13],this.z=e[14],this}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}class G{constructor(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}copy(e){const t=this.elements;return e=e.elements,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],this}multiplyMatrices(e,t){var r=e.elements,i=t.elements;t=this.elements,e=r[0];const n=r[4],s=r[8],o=r[12],a=r[1],l=r[5],u=r[9],h=r[13],c=r[2],d=r[6],p=r[10],f=r[14],m=r[3],g=r[7],v=r[11];r=r[15];const x=i[0],y=i[4],b=i[8],M=i[12],w=i[1],A=i[5],S=i[9],P=i[13],_=i[2],O=i[6],T=i[10],E=i[14],j=i[3],U=i[7],C=i[11];return i=i[15],t[0]=e*x+n*w+s*_+o*j,t[4]=e*y+n*A+s*O+o*U,t[8]=e*b+n*S+s*T+o*C,t[12]=e*M+n*P+s*E+o*i,t[1]=a*x+l*w+u*_+h*j,t[5]=a*y+l*A+u*O+h*U,t[9]=a*b+l*S+u*T+h*C,t[13]=a*M+l*P+u*E+h*i,t[2]=c*x+d*w+p*_+f*j,t[6]=c*y+d*A+p*O+f*U,t[10]=c*b+d*S+p*T+f*C,t[14]=c*M+d*P+p*E+f*i,t[3]=m*x+g*w+v*_+r*j,t[7]=m*y+g*A+v*O+r*U,t[11]=m*b+g*S+v*T+r*C,t[15]=m*M+g*P+v*E+r*i,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],n=e[12],s=e[1],o=e[5],a=e[9],l=e[13],u=e[2],h=e[6],c=e[10],d=e[14];return e[3]*(+n*a*h-i*l*h-n*o*c+r*l*c+i*o*d-r*a*d)+e[7]*(+t*a*d-t*l*c+n*s*c-i*s*d+i*l*u-n*a*u)+e[11]*(+t*l*h-t*o*d-n*s*h+r*s*d+n*o*u-r*l*u)+e[15]*(-i*o*u-t*a*h+t*o*c+i*s*h-r*s*c+r*a*u)}getInverse(e,t){t=this.elements;var r=e.elements;e=r[0];const i=r[1],n=r[2],s=r[3],o=r[4],a=r[5],l=r[6],u=r[7],h=r[8],c=r[9],d=r[10],p=r[11],f=r[12],m=r[13],g=r[14],v=c*g*u-m*d*u+m*l*p-a*g*p-c*l*(r=r[15])+a*d*r,x=f*d*u-h*g*u-f*l*p+o*g*p+h*l*r-o*d*r,y=h*m*u-f*c*u+f*a*p-o*m*p-h*a*r+o*c*r,b=f*c*l-h*m*l-f*a*d+o*m*d+h*a*g-o*c*g;var M=e*v+i*x+n*y+s*b;return 0===M?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(M=1/M,t[0]=v*M,t[1]=(m*d*s-c*g*s-m*n*p+i*g*p+c*n*r-i*d*r)*M,t[2]=(a*g*s-m*l*s+m*n*u-i*g*u-a*n*r+i*l*r)*M,t[3]=(c*l*s-a*d*s-c*n*u+i*d*u+a*n*p-i*l*p)*M,t[4]=x*M,t[5]=(h*g*s-f*d*s+f*n*p-e*g*p-h*n*r+e*d*r)*M,t[6]=(f*l*s-o*g*s-f*n*u+e*g*u+o*n*r-e*l*r)*M,t[7]=(o*d*s-h*l*s+h*n*u-e*d*u-o*n*p+e*l*p)*M,t[8]=y*M,t[9]=(f*c*s-h*m*s-f*i*p+e*m*p+h*i*r-e*c*r)*M,t[10]=(o*m*s-f*a*s+f*i*u-e*m*u-o*i*r+e*a*r)*M,t[11]=(h*a*s-o*c*s-h*i*u+e*c*u+o*i*p-e*a*p)*M,t[12]=b*M,t[13]=(h*m*n-f*c*n+f*i*d-e*m*d-h*i*g+e*c*g)*M,t[14]=(f*a*n-o*m*n-f*i*l+e*m*l+o*i*g-e*a*g)*M,t[15]=(o*c*n-h*a*n+h*i*l-e*c*l-o*i*d+e*a*d)*M,this)}compose(e,t,r){const i=this.elements;var n=t._x,s=t._y,o=t._z,a=t._w,l=n+n,u=s+s,h=o+o;t=n*l;const c=n*u;n*=h;const d=s*u;s*=h,o*=h,l*=a,u*=a,a*=h,h=r.x;const p=r.y;return r=r.z,i[0]=(1-(d+o))*h,i[1]=(c+a)*h,i[2]=(n-u)*h,i[3]=0,i[4]=(c-a)*p,i[5]=(1-(t+o))*p,i[6]=(s+l)*p,i[7]=0,i[8]=(n+u)*r,i[9]=(s-l)*r,i[10]=(1-(t+d))*r,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}makePerspective(e,t,r,i,n,s){const o=this.elements;return o[0]=2*n/(t-e),o[4]=0,o[8]=(t+e)/(t-e),o[12]=0,o[1]=0,o[5]=2*n/(r-i),o[9]=(r+i)/(r-i),o[13]=0,o[2]=0,o[6]=0,o[10]=-(s+n)/(s-n),o[14]=-2*s*n/(s-n),o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}}class D{constructor(e=0,t=0,r=0,i=D.DefaultOrder){Object.defineProperty(this,"isEuler",{value:!0}),this._x=e,this._y=t,this._z=r,this._order=i}set z(e){this._z=e,this._onChangeCallback()}_onChange(e){return this._onChangeCallback=e,this}}D.DefaultOrder="XYZ",D.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");class F{constructor(){this.mask=1}enable(e){this.mask=this.mask|1<<e|0}test(e){return 0!=(this.mask&e.mask)}}let I=0;t.DefaultUp=new V(0,1,0),t.DefaultMatrixAutoUpdate=!0,t.prototype={constructor:t,isObject3D:!0,add:function(e){return e&&e.isObject3D&&(e.parent=this,this.children.push(e)),this},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].updateMatrixWorld(e)}};class z{constructor(e,t){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=void 0!==e?e:new V(1,0,0),this.constant=void 0!==t?t:0}}class N{constructor(e,t,r){return Object.defineProperty(this,"isColor",{value:!0}),void 0===t&&void 0===r?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor||"number"==typeof e&&this.setHex(e),this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}}N.prototype.r=1,N.prototype.g=1,N.prototype.b=1;class L{constructor(e,t,r,i,n,s){this.a=e,this.b=t,this.c=r,this.normal=i&&i.isVector3?i:new V,this.vertexNormals=Array.isArray(i)?i:[],this.color=n&&n.isColor?n:new N,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=void 0!==s?s:0}}let W=0;r.prototype={constructor:r,isMaterial:!0,customProgramCacheKey:function(){return""},setValues:function(e){if(void 0!==e)for(const t in e){const r=e[t],i=this[t];i&&i.isColor||i&&i.isVector3&&r&&r.isVector3||(this[t]=r)}}},Object.assign(i.prototype,{isBufferAttribute:!0,copyColorsArray:function(e){const t=this.array;let r=0;for(let i=0,n=e.length;i<n;i++){let n=e[i];t[r++]=n.r,t[r++]=n.g,t[r++]=n.b}return this},copyVector2sArray:function(e){const t=this.array;let r=0;for(let i=0,n=e.length;i<n;i++){let n=e[i];t[r++]=n.x,t[r++]=n.y}return this},copyVector3sArray:function(e){const t=this.array;let r=0;for(let i=0,n=e.length;i<n;i++){let n=e[i];t[r++]=n.x,t[r++]=n.y,t[r++]=n.z}return this},getX:function(e){return this.array[e*this.itemSize]},getY:function(e){return this.array[e*this.itemSize+1]},getZ:function(e){return this.array[e*this.itemSize+2]}}),n.prototype=Object.create(i.prototype),n.prototype.constructor=n,s.prototype=Object.create(i.prototype),s.prototype.constructor=s;let B=1;o.prototype={constructor:o,isBufferGeometry:!0,setIndex:function(e){if(Array.isArray(e)){if(0===e.length)var t=-1/0;else{t=e[0];for(let r=1,i=e.length;r<i;++r)e[r]>t&&(t=e[r])}this.index=new n(e,1)}return this},setAttribute:function(e,t){return this.attributes[e]=t,this},setFromObject:function(e){const t=e.geometry;return e.isPoints||e.isLine||e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t),this},fromGeometry:function(e){return e.__directGeometry=(new class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}fromGeometry(e){const t=e.faces,r=e.vertices,i=e.faceVertexUvs,n=i[0]&&0<i[0].length;for(let e=0;e<t.length;e++){var s=t[e];this.vertices.push(r[s.a],r[s.b],r[s.c]);const o=s.vertexNormals;3===o.length&&this.normals.push(o[0],o[1],o[2]),3!==s.vertexColors.length&&(s=s.color,this.colors.push(s,s,s)),!0===n&&void 0!==(s=i[0][e])&&this.uvs.push(s[0],s[1],s[2])}return this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}}).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);return this.setAttribute("position",new i(t,3).copyVector3sArray(e.vertices)),0<e.normals.length&&(t=new Float32Array(3*e.normals.length),this.setAttribute("normal",new i(t,3).copyVector3sArray(e.normals))),0<e.colors.length&&(t=new Float32Array(3*e.colors.length),this.setAttribute("color",new i(t,3).copyColorsArray(e.colors))),0<e.uvs.length&&(t=new Float32Array(2*e.uvs.length),this.setAttribute("uv",new i(t,2).copyVector2sArray(e.uvs))),this.groups=e.groups,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}},a.prototype=Object.assign(Object.create(t.prototype),{constructor:a,isMesh:!0}),l.prototype=Object.create(r.prototype),l.prototype.constructor=l,l.prototype.isShaderMaterial=!0,u.prototype=Object.assign(Object.create(t.prototype),{constructor:u,isCamera:!0,updateMatrixWorld:function(e){t.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)}}),h.prototype=Object.assign(Object.create(u.prototype),{constructor:h,isPerspectiveCamera:!0,updateProjectionMatrix:function(){const e=this.near;let t=e*Math.tan(.5*O.DEG2RAD*this.fov)/this.zoom,r=2*t,i=this.aspect*r,n=-.5*i;this.projectionMatrix.makePerspective(n,n+i,t,t-r,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}});class k extends o{constructor(e,t,r,i){super(),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};var n=(e=e||1)/2,o=(t=t||1)/2;const a=(r=Math.floor(r)||1)+1;var l=(i=Math.floor(i)||1)+1,u=e/r,h=t/i;t=[],e=[];const c=[],d=[];for(let t=0;t<l;t++){const s=t*h-o;for(let o=0;o<a;o++)e.push(o*u-n,-s,0),c.push(0,0,1),d.push(o/r),d.push(1-t/i)}for(n=0;n<i;n++)for(o=0;o<r;o++)l=o+a*(n+1),u=o+1+a*(n+1),h=o+1+a*n,t.push(o+a*n,l,h),t.push(l,u,h);this.setIndex(t),this.setAttribute("position",new s(e,3)),this.setAttribute("normal",new s(c,3)),this.setAttribute("uv",new s(d,2))}}const R={encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) { return value; }"},X=new e,q=new Float32Array(16),Y=/([\w\d_]+)(\])?(\[|\.)?/g;g.prototype.setValue=function(e,t,r,i){void 0!==(t=this.map[t])&&t.setValue(e,r,i)},g.upload=function(e,t,r,i){for(let n=0,s=t.length;n!==s;++n){const s=t[n],o=r[s.id];!1!==o.needsUpdate&&s.setValue(e,o.value,i)}},g.seqWithValue=function(e,t){const r=[];for(let i=0,n=e.length;i!==n;++i){const n=e[i];n.id in t&&r.push(n)}return r};let H=0;const Z=/^[ \t]*#include +<([\w\d./]+)>/gm;S.prototype=Object.assign(Object.create(h.prototype),{constructor:S,isArrayCamera:!0}),P.prototype=Object.create(e.prototype),P.prototype.constructor=P,P.prototype.isCanvasTexture=!0;let K=0;return _.prototype={constructor:_,isGeometry:!0,fromBufferGeometry:function(e){const t=null!==e.index?e.index:void 0;var r=e.attributes,i=r.position;const n=r.normal,s=r.color,o=r.uv;for(void 0!==r.uv2&&(this.faceVertexUvs[1]=[]),r=0;r<i.count;r++)this.vertices.push((new V).fromBufferAttribute(i,r));if(!(0<e.groups.length)&&void 0!==t)for(let l=0;l<t.count;l+=3){e=t.getX(l),i=t.getX(l+1),r=t.getX(l+2);var a=void 0===s?[]:[this.colors[e].clone(),this.colors[i].clone(),this.colors[r].clone()];const u=void 0===n?[]:[(new V).fromBufferAttribute(n,e),(new V).fromBufferAttribute(n,i),(new V).fromBufferAttribute(n,r)];a=new L(e,i,r,u,a,void 0),this.faces.push(a),void 0!==o&&this.faceVertexUvs[0].push([(new T).fromBufferAttribute(o,e),(new T).fromBufferAttribute(o,i),(new T).fromBufferAttribute(o,r)])}return this},merge:function(e,t){var r=this.vertices.length,i=this.vertices,n=e.vertices,s=this.faces;const o=e.faces;var a=(new E).getNormalMatrix(t);for(let e=0,r=n.length;e<r;e++){var l=n[e].clone();l.applyMatrix4(t),i.push(l)}for(let e=0,u=o.length;e<u;e++){n=(t=o[e]).vertexNormals,(l=new L(t.a+r,t.b+r,t.c+r)).normal.copy(t.normal),void 0!==a&&l.normal.applyMatrix3(a).normalize();for(let e=0,t=n.length;e<t;e++)i=n[e].clone(),void 0!==a&&i.applyMatrix3(a).normalize(),l.vertexNormals.push(i);l.color.copy(t.color),l.materialIndex=t.materialIndex,s.push(l)}for(let t=0,i=e.faceVertexUvs.length;t<i;t++){a=e.faceVertexUvs[t],void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]);for(let e=0,i=a.length;e<i;e++){s=[];for(let t=0,i=(r=a[e]).length;t<i;t++)s.push(r[t].clone());this.faceVertexUvs[t].push(s)}}}},{WebGLRenderer:function(e){function t(e,t,r){const i=!0===t.isScene?t.overrideMaterial:null;for(let h=0,c=e.length;h<c;h++){var n=e[h],s=n.object,o=n.geometry,a=null===i?n.material:i,l=n.group;if(!r.isArrayCamera){x=null,n=t;var u=r;p=B.get(n,x||u),s.modelViewMatrix.multiplyMatrices(u.matrixWorldInverse,s.matrixWorld),s.normalMatrix.getNormalMatrix(s.modelViewMatrix),s.isImmediateRenderObject||f.renderBufferDirect(u,n,o,a,s,l),p=B.get(n,x||u)}}}const r=(e=e||{}).canvas;var i=void 0!==e.context?e.context:null,n=void 0!==e.alpha&&e.alpha;const s=void 0===e.depth||e.depth,a=void 0!==e.antialias&&e.antialias;var l=void 0===e.premultipliedAlpha||e.premultipliedAlpha;const u=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,h=void 0!==e.powerPreference?e.powerPreference:"default",c=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;let d=null,p=null;this.domElement=r,this.sortObjects=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.gammaFactor=2,this.outputEncoding=3e3;const f=this;let m=-1,v=null,x=null;const y=new U;var b=new U;let w=r.width,S=r.height;const P=new U(0,0,w,S);var _=new U(0,0,w,S);new class{constructor(e,t,r,i,n,s){this.planes=[void 0!==e?e:new z,void 0!==t?t:new z,void 0!==r?r:new z,void 0!==i?i:new z,void 0!==n?n:new z,void 0!==s?s:new z]}};const T=new G,E=new V,j={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let C,D,F,I,N,L,W,B,k,R,X=i;i={alpha:n,depth:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:h,failIfMajorPerformanceCaveat:c},null===X&&(X=function(e,t){for(let i=0;i<e.length;i++){const n=r.getContext(e[i],t);if(null!==n)return n}return null}(["webgl"],i)),i=new function(e){const t={};return{has:function(e){return!0},get:function(e){return this.has(e),t[e]}}}(X),e=new function(e,t,r){function i(t){return"highp"===t&&0<e.getShaderPrecisionFormat(35633,36338).precision&&0<e.getShaderPrecisionFormat(35632,36338).precision?"highp":"lowp"}let n=void 0!==r.precision?r.precision:"highp";return i(n),r=!0===r.logarithmicDepthBuffer,e.getParameter(35660),{isWebGL2:0,getMaxPrecision:i,precision:n}}(X,i,e),n=new function(){return{convert:function(e){return 1009===e?5121:1023===e?6408:void 0}}}(X,i,e),C=new function(e,t){function r(t,r,i){const n=new Uint8Array(4),s=e.createTexture();for(e.bindTexture(t,s),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728),t=0;t<i;t++)e.texImage2D(r+t,0,6408,1,1,0,6408,5121,n);return s}function i(t){!0!==h[t]&&(e.enable(t),h[t]=!0)}function n(t){!1!==h[t]&&(e.disable(t),h[t]=!1)}function s(t,r,n,s,o,a,l,u){if(0!==t)if(d||(i(3042),d=!0),5!==t){if(t!==p||u!==g){if(100===f&&100===m||(e.blendEquation(32774),m=f=100),!u)switch(t){case 1:e.blendFuncSeparate(770,771,1,771)}p=t,g=u}}else p=t,g=null}function o(t){v!==t&&(t||e.frontFace(2305),v=t)}function a(t){0!==t&&(i(2884),t!==x&&1===t&&e.cullFace(1029)),x=t}const l=new function(){const t=new U;let r=null;const i=new U(0,0,0,0);return{setMask:function(t){r!==t&&(e.colorMask(t,t,t,t),r=t)},setClear:function(r,n,s,o,a){!0===a&&(r*=o,n*=o,s*=o),t.set(r,n,s,o),!1===i.equals(t)&&(e.clearColor(r,n,s,o),i.copy(t))}}},u=new function(){let t=null,r=null,s=null;return{setTest:function(e){e?i(2929):n(2929)},setMask:function(r){t!==r&&(e.depthMask(r),t=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case 3:e.depthFunc(515)}r=t}},setClear:function(t){s!==t&&(e.clearDepth(t),s=t)}}};let h={},c=null,d=null,p=null,f=null,m=null,g=!1,v=null,x=null;const y=e.getParameter(35661);-1!==(t=e.getParameter(7938)).indexOf("WebGL")?parseFloat(/^WebGL ([0-9])/.exec(t)[1]):t.indexOf("OpenGL ES");let b=null,M={};new U;const w=new U,A={};return A[3553]=r(3553,3553,1),A[34067]=r(34067,34069,6),l.setClear(0,0,0,1),u.setClear(1),i(2929),u.setFunc(3),o(!1),a(1),i(2884),s(0),{buffers:{color:l,depth:u},enable:i,disable:n,useProgram:function(t){return c!==t&&(e.useProgram(t),c=t,!0)},setBlending:s,setMaterial:function(e,t){2===e.side?n(2884):i(2884);let r=1===e.side;t&&(r=!r),o(r),1===e.blending&&!1===e.transparent?s(0):s(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),u.setFunc(e.depthFunc),u.setTest(e.depthTest),u.setMask(e.depthWrite),l.setMask(e.colorWrite),e.polygonOffset||n(32823)},setFlipSided:o,setCullFace:a,activeTexture:function(t){void 0===t&&(t=33984+y-1),b!==t&&(e.activeTexture(t),b=t)},bindTexture:function(t,r){let i=M[b];void 0===i&&(i={type:void 0,texture:void 0},M[b]=i),i.type===t&&i.texture===r||(e.bindTexture(t,r||A[t]),i.type=t,i.texture=r)},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){}},viewport:function(t){!1===w.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),w.copy(t))}}}(X,i,e),b=new function(){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,r,i){switch(e.calls++,r){case 4:e.triangles+=t/3*i}}}}(X),D=new function(){let e=new WeakMap;return{get:function(t){let r=e.get(t);return void 0===r&&(r={},e.set(t,r)),r}}},F=new function(e,t,r,i,n,s,o){function a(e){return O.isPowerOfTwo(e.width)&&O.isPowerOfTwo(e.height)}function l(t,n){const l=i.get(t);if(0<t.version&&l.__version!==t.version){var h=t.image;if(void 0!==h&&!1!==h.complete){h=3553,void 0===l.__webglInit&&(l.__webglInit=!0,l.__webglTexture=e.createTexture(),o.memory.textures++),r.activeTexture(33984+n),r.bindTexture(h,l.__webglTexture),e.pixelStorei(37440,t.flipY),e.pixelStorei(37441,t.premultiplyAlpha),e.pixelStorei(3317,t.unpackAlignment),!u&&(1001!==t.wrapS||1001!==t.wrapT||1003!==t.minFilter&&1006!==t.minFilter)&&a(t.image);var p=a(n=t.image)||u;const g=s.convert(t.format);let v=s.convert(t.type);if(!1===u)var f=g;else f=g,6408===g&&(5126===v&&(f=34836),5131===v&&(f=34842),5121===v&&(f=32856));var m=h;return p&&(e.texParameteri(m,10242,c[t.wrapS]),e.texParameteri(m,10243,c[t.wrapT]),e.texParameteri(m,10240,d[t.magFilter]),e.texParameteri(m,10241,d[t.minFilter])),m=t.mipmaps,r.texImage2D(3553,0,6408,6408,5121,n),l.__maxMipLevel=0,t.generateMipmaps&&p&&1003!==t.minFilter&&1006!==t.minFilter&&(p=n.width,n=n.height,e.generateMipmap(h),i.get(t).__maxMipLevel=Math.log(Math.max(p,n))*Math.LOG2E),l.__version=t.version,void(t.onUpdate&&t.onUpdate(t))}}r.activeTexture(33984+n),r.bindTexture(3553,l.__webglTexture)}const u=n.isWebGL2;let h=0;const c={1000:10497,1001:33071,1002:33648},d={1003:9728,1004:9984,1005:9986,1006:9729,1007:9985,1008:9987};this.allocateTextureUnit=function(){const e=h;return h+=1,e},this.resetTextureUnits=function(){h=0},this.setTexture2D=l,this.safeSetTexture2D=function(e,t){l(e,t)}}(X,i,C,D,e,n,b),I=new function(){return{get:function(e){return e}}}(f),_=new function(e){const t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},update:function(r,i){if(r.isInterleavedBufferAttribute&&(r=r.data),void 0===t.get(r)){var n=t.set,s=r;const o=r.array,a=r.usage,l=e.createBuffer();e.bindBuffer(i,l),e.bufferData(i,o,a),i=5126,o instanceof Float32Array&&(i=5126),n.call(t,s,{buffer:l,type:i,bytesPerElement:o.BYTES_PER_ELEMENT,version:r.version})}}}}(X,e),R=new function(e,t,r,i){function n(e){const t=[],r=[],i=[];for(let e=0;e<l;e++)t[e]=0,r[e]=0,i[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:r,attributeDivisors:i,object:e,attributes:{},index:null}}function s(){const e=d.newAttributes;for(let t=0,r=e.length;t<r;t++)e[t]=0}function o(t){const r=d.enabledAttributes;d.newAttributes[t]=1,0===r[t]&&(e.enableVertexAttribArray(t),r[t]=1)}function a(){for(let e=0,t=d.enabledAttributes.length;e<t;e++);}const l=e.getParameter(34921),u=i.isWebGL2?null:e.getExtension("OES_vertex_array_object"),h=i.isWebGL2||null!==u,c={};let d=n(null);return{setup:function(t,l,p,f,m){if(t=!1,h){t=!0===l.wireframe;var g=c[f.id];void 0===g&&(g={},c[f.id]=g),void 0===(l=g[p.id])&&(l={},g[p.id]=l),void 0===(g=l[t])&&(g=n(i.isWebGL2?e.createVertexArray():u.createVertexArrayOES()),l[t]=g),d!==(t=g)&&(t=(d=t).object,i.isWebGL2?e.bindVertexArray(t):u.bindVertexArrayOES(t));e:if(t=d.attributes,l=f.attributes,Object.keys(t).length!==Object.keys(l).length)t=!0;else{for(var v in l){g=t[v];const e=l[v];if(void 0===g||g.attribute!==e||g.data!==e.data){t=!0;break e}}t=d.index!==m}if(t){for(var x in v={},l=f.attributes)(g={}).attribute=l[x],v[x]=g;d.attributes=v,d.index=m}}if(t){s(),f=f.attributes,p=p.getAttributes();for(const n in p)0<=(m=p[n])&&void 0!==(x=f[n])&&(v=x.normalized,t=x.itemSize,void 0!==(g=r.get(x))&&(l=g.buffer,g=g.type,x.isInterleavedBufferAttribute||(x.isInstancedBufferAttribute||o(m),e.bindBuffer(34962,l),(!0!==i.isWebGL2||5124!==g&&5125!==g)&&e.vertexAttribPointer(m,t,g,v,0,0))));a()}},initAttributes:s,enableAttribute:o,disableUnusedAttributes:a}}(X,i,_,e),n=new function(e,t,r){const i=new WeakMap;return{get:function(e,t){let n=i.get(t);return n||(!t.isBufferGeometry&&t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new o).setFromObject(e)),n=t._bufferGeometry),i.set(t,n),r.memory.geometries++,n)},update:function(e){e=e.attributes;for(const r in e)t.update(e[r],34962)}}}(X,_,b,R),N=new function(e,t,r,i){let n=new WeakMap;return{update:function(e){const r=i.render.frame,s=e.geometry,o=t.get(e,s);return n.get(o)!==r&&(s.isGeometry,t.update(o),n.set(o,r)),o}}}(X,n,_,b),L=new M(f,I,i,e,R),W=new A(D),B=new function(e,t){let r=new WeakMap;return{get:function(i,n){let s;return!1===r.has(i)?(s=new function(){const e=[],t=[];return{init:function(){e.length=0,t.length=0},state:{lightsArray:e,shadowsArray:t,lights:{state:{}}}}}(e,t),r.set(i,new WeakMap),r.get(i).set(n,s)):!1!==r.get(i).has(n)&&(s=r.get(i).get(n)),s}}}(i,e),k=new function(e,t,r){let i;this.setMode=function(e){i=e},this.render=function(t,n){e.drawArrays(i,t,n),r.update(n,i,1)}}(X,i,b,e),b.programs=L.programs,f.extensions=i,f.state=C,f.info=b,this.getContext=function(){return X},this.setSize=function(e,t){w=e,S=t,r.width=Math.floor(1*e),r.height=Math.floor(1*t),this.setViewport(0,0,e,t)},this.setViewport=function(e,t,r,i){e.isVector4||P.set(e,t,r,i),C.viewport(y.copy(P).multiplyScalar(1).floor())},this.clear=function(e,t,r){let i=0;(void 0===e||e)&&(i|=16384),(void 0===t||t)&&(i|=256),(void 0===r||r)&&(i|=1024),X.clear(i)},this.renderBufferDirect=function(e,t,r,i,n,s){null===t&&(t=j);var o=n.isMesh&&0>n.matrixWorld.determinant(),a=t;if(!0!==a.isScene&&(a=j),F.resetTextureUnits(),t=i.isMeshStandardMaterial?a.environment:null,I.get(i.envMap||t),t=D.get(i),i.version!==t.__version){var l=a;!0!==l.isScene&&(l=j),a=D.get(i);var u=p.state.lights,h=u.state.version;u=L.getParameters(i,u.state,p.state.shadowsArray,l,n);var c=L.getProgramCacheKey(u);u.uniforms=L.getUniforms(i),c=L.acquireProgram(u,c),a.program=c,a.uniforms=u.uniforms,a.outputEncoding=u.outputEncoding,u=a.uniforms,a.environment=i.isMeshStandardMaterial?l.environment:null,a.fog=l.fog,a.envMap=I.get(i.envMap||a.environment),a.lightsStateVersion=h,l=a.program.getUniforms(),l=g.seqWithValue(l.seq,u),a.uniformsList=l,t.__version=i.version}h=l=!1,u=(a=t.program).getUniforms(),c=t.uniforms,C.useProgram(a.program)&&(h=l=!0),i.id!==m&&(m=i.id,h=!0),(l||v!==e)&&(u.setValue(X,"projectionMatrix",e.projectionMatrix),v!==e&&(v=e,h=!0),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&u.setValue(X,"isOrthographic",!0===e.isOrthographicCamera),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&u.setValue(X,"viewMatrix",e.matrixWorldInverse)),h&&(u.setValue(X,"toneMappingExposure",f.toneMappingExposure),g.upload(X,t.uniformsList,c,F)),u.setValue(X,"modelViewMatrix",n.modelViewMatrix),u.setValue(X,"normalMatrix",n.normalMatrix),u.setValue(X,"modelMatrix",n.matrixWorld),C.setMaterial(i,o),e=r.index,o=r.attributes.position,(null!==e||void 0!==o&&0!==o.count)&&(R.setup(n,i,a,r,e),a=1*r.drawRange.start,l=null!==s?1*s.start:0,t=Math.max(a,l),0!==(s=Math.max(0,Math.min(null!==e?e.count:o.count,a+1*r.drawRange.count,l+(null!==s?1*s.count:1/0))-1-t+1))&&(n.isMesh&&!0!==i.wireframe&&k.setMode(4),n.isInstancedMesh||r.isInstancedBufferGeometry||k.render(t,s)))},this.render=function(e,r,i,n){m=-1,v=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),(p=B.get(e,r)).init(),T.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),(d=W.get(e,r)).init(),function e(t,r,i,n){if(!1!==t.visible){if(!(!t.layers.test(r.layers)||t.isGroup||t.isLOD||t.isSprite||t.isImmediateRenderObject)&&(t.isMesh||t.isLine||t.isPoints)){n&&E.setFromMatrixPosition(t.matrixWorld).applyMatrix4(T);const e=N.update(t),r=t.material;Array.isArray(r)||r.visible&&d.push(t,e,r,i,E.z,null)}for(let s=0,o=(t=t.children).length;s<o;s++)e(t[s],r,i,n)}}(e,r,0,f.sortObjects),!0===f.sortObjects&&d.sort(null,null),!0===this.info.autoReset&&this.info.reset(),i=d.opaque,n=d.transparent,0<i.length&&t(i,e,r),0<n.length&&t(n,e,r)}},PerspectiveCamera:h,CanvasTexture:P,LinearFilter:1006,LinearMipMapLinearFilter:1008,Fog:class{constructor(e,t,r){Object.defineProperty(this,"isFog",{value:!0}),this.name="",this.color=new N(e),this.near=void 0!==t?t:1,this.far=void 0!==r?r:1e3}},ShaderMaterial:l,Mesh:a,PlaneGeometry:class extends _{constructor(e,t,r,i){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i},this.fromBufferGeometry(new k(e,t,r,i))}},Geometry:_,Scene:class extends t{constructor(){super(),Object.defineProperty(this,"isScene",{value:!0}),this.type="Scene",this.overrideMaterial=this.fog=this.environment=this.background=null,this.autoUpdate=!0}}}}